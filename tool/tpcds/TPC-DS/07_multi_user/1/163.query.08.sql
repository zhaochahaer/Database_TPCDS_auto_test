:EXPLAIN_ANALYZE
-- start query 63 in stream 0 using template query8.tpl and seed 1180919748
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '18402','79852','65759','40720','19778','28234',
                          '23682','81720','64368','68643','14590',
                          '52937','84398','91890','86941','70395',
                          '66021','39869','38495','27096','99056',
                          '91044','74896','24424','18189','24555',
                          '86070','87077','49626','92273','20151',
                          '18972','84426','99983','80629','24834',
                          '92477','65616','24450','54999','10029',
                          '31253','44228','16571','89306','14585',
                          '33008','61591','42893','57854','15481',
                          '91034','42986','70329','71943','47669',
                          '77031','22854','20127','10624','17449',
                          '98461','42797','26954','28157','17096',
                          '53228','34619','18868','31346','72147',
                          '27494','14709','28794','76135','28394',
                          '86928','35906','71529','18858','72589',
                          '66565','83902','40745','54829','14617',
                          '72300','12743','87193','30543','16622',
                          '29727','75985','32531','33135','53117',
                          '10580','25117','77012','68849','21247',
                          '63065','29762','24672','85870','30542',
                          '35260','18513','25717','90500','73356',
                          '16348','98602','89152','54240','92092',
                          '61580','51117','62667','93795','85223',
                          '98203','75042','28202','28836','29622',
                          '34167','91135','33986','13892','46939',
                          '56704','60902','91661','29991','48800',
                          '37027','30205','75073','16833','99653',
                          '98386','41451','40591','46229','76538',
                          '60858','55918','11588','54921','31709',
                          '77662','14273','98652','17831','67198',
                          '51020','39129','84520','36036','36513',
                          '38717','96290','40672','77966','30110',
                          '15541','10889','55715','81871','31906',
                          '64679','34092','55822','14205','42401',
                          '74274','26378','18432','47126','55462',
                          '25529','74075','41063','21728','53066',
                          '64931','13234','40103','64122','35904',
                          '60380','43585','22715','80208','40977',
                          '73320','85267','30843','82307','61068',
                          '91570','68116','26897','25727','41421',
                          '32756','44775','30952','89804','95774',
                          '23440','44143','30563','42844','18147',
                          '13366','43932','33246','59060','80618',
                          '41857','28269','88032','25945','39304',
                          '22540','61436','64253','28652','23843',
                          '38160','27655','72121','49826','45611',
                          '41198','63776','29619','39133','34081',
                          '41771','50063','50412','13043','35530',
                          '32381','28721','79469','43642','85327',
                          '14627','68858','53459','46378','70953',
                          '51088','10804','38779','73425','38885',
                          '17656','12146','15981','35490','77768',
                          '72141','19295','63927','35283','80872',
                          '13852','33577','95946','35484','48303',
                          '56310','32214','14998','91164','39695',
                          '31689','19158','62571','13551','61867',
                          '38716','53608','18411','16142','36421',
                          '17987','98352','97010','87106','15245',
                          '54708','84925','52269','86117','14704',
                          '15844','18193','15292','14051','46487',
                          '82094','81051','34218','56199','79335',
                          '28541','29983','49319','32091','16781',
                          '53105','24959','20412','76531','48258',
                          '98288','12194','12285','53335','17776',
                          '63611','45774','22584','64188','42567',
                          '59608','51621','67446','47160','14183',
                          '33082','51137','38462','97962','29512',
                          '50987','75642','67417','54479','15326',
                          '43763','25915','45651','50231','60176',
                          '23889','72094','53373','44921','50915',
                          '21273','38207','64763','62003','56607',
                          '18502','49676','69414','94395','11625',
                          '28393','94051','79196','12698','81364',
                          '77589','49710','40954','39373','37373',
                          '36960','39109','81551','56236','57873',
                          '75473','87879','48479','33079','23326',
                          '25527','98694','27571','78397','13816',
                          '85299','38469','35196','74866','97232',
                          '36634','74171','28098','33147')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;

-- end query 63 in stream 0 using template query8.tpl
